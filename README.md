# Explaining Generative Diffusion Models via Visual Analysis for Interpretable Decision-Making Process

Official implementation of the paper "[Explaining generative diffusion models via visual analysis for interpretable decision-making process](https://www.sciencedirect.com/science/article/pii/S0957417424000964)," accepted by **Expert Systems with Applications 2024**.

<p align="center">
  <img src="https://github.com/ian-jihoonpark/X-Diffusion/assets/77654517/84457e37-e30a-4ba7-8239-b2bde5b57229" width="512" height="512">
</p>

## Code Files
- **`DF-CAM_auc.py`:** Computes the AUC score for DF-CAM.
- **`DF_CAM.ipynb`:** Visualizes diffusion models using DF-CAM (Figure 8).
- **`conda_requirements.yaml`:** If you use Conda, utilize this file for environment setup.
- **`DF_Crossattn.ipynb`:** Computes cross-attention scores (Figure 9, Figure 11).
<p align="center">
  <img src="https://github.com/ian-jihoonpark/X-Diffusion/assets/77654517/bb1cfe47-a07d-4614-85a6-72109b674941" width="400" height="400">
</p>

- **`DF_LIME.ipynb`:** Implements the Lime method for diffusion models as a baseline. (Figure3)

<p align="center">
  <img src="https://github.com/ian-jihoonpark/X-Diffusion/assets/77654517/27c8ff0f-ffb1-43ba-bcf3-8cf5b531bb29" width="512" height="512">
</p>

- **`Experiments.ipynb`:** Contains DF-RISE visualization experiments and exponential scheduler experiments (Figure 6, Figure 7, Figure 8, Figure 10).
<p align="center">
  <img src="https://github.com/ian-jihoonpark/X-Diffusion/assets/77654517/5a07fbf5-5e70-48e7-ba52-73c7f5a88412" width="400" height="400">
  <img src="https://github.com/ian-jihoonpark/X-Diffusion/assets/77654517/ddfba13e-9f4e-46a7-bc5a-a6848a4acd96" width="400" height="400">
</p>

<p align="center">
  <img src="https://github.com/ian-jihoonpark/X-Diffusion/assets/77654517/81cfb597-86ec-4926-b584-7b80ad42e460" width="400" height="400">
  <img src="https://github.com/ian-jihoonpark/X-Diffusion/assets/77654517/c9c303b4-b3fa-42a2-897f-7e17faa588c8" width="400" height="400">
</p>

- **`requirements.txt`:** Contains the list of packages required for environment setup.
- **`DF_RISE_auc.py`:** Computes the AUC score for DF-RISE.

## Installation
### Environment Setup
1. Clone this repository:
   git clone https://github.com/username/repository-name.git](https://github.com/ian-jihoonpark/X-Diffusion.git
 ### Requirements
2. install requirements
```bash
   pip install -r requirements.txt
